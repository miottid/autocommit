#!/bin/sh
# Pre-commit hook for Rust formatting
# This hook automatically formats Rust code and re-stages the changes

set -e

echo "Running cargo fmt..."

# Check if any Rust files are staged
if git diff --cached --name-only | grep -q '\.rs$'; then
    # Format all Rust code
    cargo fmt --all

    # Re-stage any Rust files that were already staged
    git diff --cached --name-only | grep '\.rs$' | while read -r file; do
        git add "$file"
    done

    echo "âœ… Code formatted and re-staged!"
fi

exit 0
